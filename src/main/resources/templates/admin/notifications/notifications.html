<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Admin - Quản lý Thông báo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="title" content="Admin - Quản lý Thông báo" />
    <meta name="author" content="Vaccines for children" />
    <!-- Fonts -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fontsource/source-sans-3@5.0.12/index.css" integrity="sha256-tXJfXfp6Ewt1ilPzLDtQnJV4hclT9XuaZUKyUvmyr+Q=" crossorigin="anonymous" />
    <!-- OverlayScrollbars -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/overlayscrollbars@2.10.1/styles/overlayscrollbars.min.css" integrity="sha256-tZHrRjVqNSRyWg2wbppGnT833E/Ys0DHWGwT04GiqQg=" crossorigin="anonymous" />
    <!-- Bootstrap Icons -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css" integrity="sha256-9kPW/n5nn53j4WMRYAxe9c1rCY96Oogo/MKSVdKzPmI=" crossorigin="anonymous" />
    <!-- AdminLTE -->
    <link rel="stylesheet" th:href="@{/dist/css/adminlte.css}" />
    <!-- DataTables -->
    <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/dataTables.bootstrap5.min.css">
</head>

<body class="layout-fixed sidebar-expand-lg bg-body-tertiary">
    <div class="app-wrapper">
        <!-- Header -->
        <nav class="app-header navbar navbar-expand bg-body">
            <div class="container-fluid">
                <ul class="navbar-nav">
                    <li class="nav-item">
                        <a class="nav-link" data-lte-toggle="sidebar" href="#" role="button">
                            <i class="bi bi-list"></i>
                        </a>
                    </li>
                    <li class="nav-item d-none d-md-block">
                        <a th:href="@{/admin}" class="nav-link">Home</a>
                    </li>
                </ul>
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="#" data-lte-toggle="fullscreen">
                            <i data-lte-icon="maximize" class="bi bi-arrows-fullscreen"></i>
                            <i data-lte-icon="minimize" class="bi bi-fullscreen-exit" style="display: none"></i>
                        </a>
                    </li>
                </ul>
            </div>
        </nav>

        <!-- Sidebar -->
        <aside class="app-sidebar bg-body-secondary shadow" data-bs-theme="dark">
            <div class="sidebar-brand">
                <a th:href="@{/admin}" class="brand-link">
                    <img th:src="@{/dist/assets/img/AdminLTELogo.png}" alt="App Logo" class="brand-image opacity-75 shadow" />
                    <span class="brand-text fw-light">Vaccine Tracker</span>
                </a>
            </div>
            <div class="sidebar-wrapper">
                <nav class="mt-2">
                    <!--begin::Sidebar Menu-->
                    <ul class="nav sidebar-menu flex-column" data-lte-toggle="treeview" role="menu" data-accordion="false">
                        <!-- Dashboard -->
                        <li class="nav-item">
                            <a th:href="@{/admin}" class="nav-link">
                                <i class="nav-icon bi bi-speedometer"></i>
                                <p>Dashboard</p>
                            </a>
                        </li>

                        <!-- Quản lí Rating, Feedback -->
                        <li class="nav-item">
                            <a th:href="@{/admin/feedbacks}" class="nav-link">
                                <i class="nav-icon bi bi-star-half"></i>
                                <p>Quản lí Rating, Feedback</p>
                            </a>
                        </li>

                        <!-- Quản lí Hồ sơ trẻ em -->
                        <li class="nav-item">
                            <a th:href="@{/admin/children}" class="nav-link">
                                <i class="nav-icon bi bi-person-badge"></i>
                                <p>Quản lí Hồ sơ trẻ em</p>
                            </a>
                        </li>

                        <!-- Quản lí Người dùng -->
                        <li class="nav-item">
                            <a th:href="@{/admin/users}" class="nav-link">
                                <i class="nav-icon bi bi-people-fill"></i>
                                <p>Quản lí Người dùng</p>
                            </a>
                        </li>

                        <!-- Quản lí Vaccine -->
                        <li class="nav-item">
                            <a th:href="@{/admin/vaccines}" class="nav-link">
                                <i class="nav-icon bi bi-shield-plus"></i>
                                <p>Quản lí Vaccine</p>
                            </a>
                        </li>

                        <!-- Quản lí Gói Vaccine -->
                        <li class="nav-item">
                            <a th:href="@{/admin/packages}" class="nav-link">
                                <i class="nav-icon bi bi-box-seam"></i>
                                <p>Quản lí Gói Vaccine</p>
                            </a>
                        </li>

                        <!-- Quản lí Thanh toán -->
                        <li class="nav-item">
                            <a th:href="@{/admin/payments}" class="nav-link">
                                <i class="nav-icon bi bi-credit-card"></i>
                                <p>Quản lí Thanh toán</p>
                            </a>
                        </li>

                        <!-- Quản lí Đặt lịch vaccine -->
                        <li class="nav-item">
                            <a th:href="@{/admin/appointments}" class="nav-link">
                                <i class="nav-icon bi bi-calendar-check"></i>
                                <p>Quản lí Đặt lịch vaccine</p>
                            </a>
                        </li>

                        <!-- Quản lí Thông báo -->
                        <li class="nav-item">
                            <a th:href="@{/admin/notifications}" class="nav-link active">
                                <i class="nav-icon bi bi-bell"></i>
                                <p>Quản lí Thông báo</p>
                            </a>
                        </li>
                    </ul>
                    <!--end::Sidebar Menu-->
                </nav>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="app-main">
            <div class="app-content-header">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-sm-6">
                            <h3 class="mb-0">Quản lí Thông báo</h3>
                        </div>
                        <div class="col-sm-6">
                            <ol class="breadcrumb float-sm-end">
                                <li class="breadcrumb-item">
                                    <a th:href="@{/admin}">Home</a>
                                </li>
                                <li class="breadcrumb-item active" aria-current="page">
                                    Quản lí Thông báo
                                </li>
                            </ol>
                        </div>
                    </div>
                </div>
            </div>

            <div class="app-content">
                <div class="container-fluid">
                    <!-- Templates Grid -->
                    <div class="row mb-4">
                        <div class="col-12">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="mb-0">Mẫu thông báo</h5>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <!-- Vaccine Template -->
                                        <div class="col-md-3">
                                            <div class="card template-card mb-0">
                                                <div class="card-body">
                                                    <div class="d-flex align-items-center mb-3">
                                                        <div class="flex-shrink-0">
                                                            <i class="bi bi-shield-plus text-success fs-2"></i>
                                                        </div>
                                                        <div class="flex-grow-1 ms-3">
                                                            <h6 class="mb-0">Nhắc lịch tiêm vaccine</h6>
                                                            <span class="badge bg-success">Tiêm lẻ</span>
                                                        </div>
                                                    </div>
                                                    <p class="card-text small text-muted">Thông báo nhắc lịch tiêm vaccine sắp đến</p>
                                                    <button class="btn btn-outline-success w-100 template-btn" 
                                                        data-type="VACCINE" 
                                                        data-title="Nhắc lịch tiêm vaccine"
                                                        data-template="Xin nhắc lịch tiêm vaccine sắp đến. Vui lòng kiểm tra lịch hẹn của bạn.">
                                                        Sử dụng mẫu này
                                                    </button>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Package Template -->
                                        <div class="col-md-3">
                                            <div class="card template-card mb-0">
                                                <div class="card-body">
                                                    <div class="d-flex align-items-center mb-3">
                                                        <div class="flex-shrink-0">
                                                            <i class="bi bi-box-seam text-warning fs-2"></i>
                                                        </div>
                                                        <div class="flex-grow-1 ms-3">
                                                            <h6 class="mb-0">Cập nhật gói vaccine</h6>
                                                            <span class="badge bg-warning">Tiêm gói</span>
                                                        </div>
                                                    </div>
                                                    <p class="card-text small text-muted">Thông báo về cập nhật gói vaccine</p>
                                                    <button class="btn btn-outline-warning w-100 template-btn"
                                                        data-type="PACKAGE" 
                                                        data-title="Thông báo về gói vaccine"
                                                        data-template="Gói vaccine của bạn đã được cập nhật. Vui lòng kiểm tra thông tin chi tiết.">
                                                        Sử dụng mẫu này
                                                    </button>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- Payment Template -->
                                        <div class="col-md-3">
                                            <div class="card template-card mb-0">
                                                <div class="card-body">
                                                    <div class="d-flex align-items-center mb-3">
                                                        <div class="flex-shrink-0">
                                                            <i class="bi bi-credit-card text-info fs-2"></i>
                                                        </div>
                                                        <div class="flex-grow-1 ms-3">
                                                            <h6 class="mb-0">Nhắc thanh toán</h6>
                                                            <span class="badge bg-info">Thanh toán</span>
                                                        </div>
                                                    </div>
                                                    <p class="card-text small text-muted">Thông báo nhắc thanh toán phí dịch vụ</p>
                                                    <button class="btn btn-outline-info w-100 template-btn"
                                                        data-type="PAYMENT" 
                                                        data-title="Nhắc thanh toán"
                                                        data-template="Vui lòng thanh toán phí dịch vụ trước khi đến lịch hẹn.">
                                                        Sử dụng mẫu này
                                                    </button>
                                                </div>
                                            </div>
                                        </div>

                                        <!-- System Template -->
                                        <div class="col-md-3">
                                            <div class="card template-card mb-0">
                                                <div class="card-body">
                                                    <div class="d-flex align-items-center mb-3">
                                                        <div class="flex-shrink-0">
                                                            <i class="bi bi-gear text-secondary fs-2"></i>
                                                        </div>
                                                        <div class="flex-grow-1 ms-3">
                                                            <h6 class="mb-0">Bảo trì hệ thống</h6>
                                                            <span class="badge bg-secondary">Hệ thống</span>
                                                        </div>
                                                    </div>
                                                    <p class="card-text small text-muted">Thông báo về bảo trì hệ thống</p>
                                                    <button class="btn btn-outline-secondary w-100 template-btn"
                                                        data-type="SYSTEM" 
                                                        data-title="Thông báo bảo trì hệ thống"
                                                        data-template="Hệ thống sẽ được bảo trì định kỳ. Mong quý khách thông cảm cho sự bất tiện này.">
                                                        Sử dụng mẫu này
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- DataTable Card -->
                    <div class="card">
                        <div class="card-header">
                            <div class="d-flex justify-content-between align-items-center">
                                <h5 class="mb-0">Danh sách thông báo</h5>
                                <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#createNotificationModal">
                                    <i class="bi bi-plus"></i> Tạo thông báo mới
                                </button>
                            </div>
                        </div>
                        <div class="card-body">
                            <!-- Filter buttons -->
                            <div class="mb-3">
                                <div class="btn-group">
                                    <button type="button" class="btn btn-outline-primary filter-btn active" data-filter="all">
                                        Tất cả
                                    </button>
                                    <button type="button" class="btn btn-outline-success filter-btn" data-filter="VACCINE">
                                        Tiêm lẻ
                                    </button>
                                    <button type="button" class="btn btn-outline-warning filter-btn" data-filter="PACKAGE">
                                        Tiêm gói
                                    </button>
                                    <button type="button" class="btn btn-outline-info filter-btn" data-filter="PAYMENT">
                                        Thanh toán
                                    </button>
                                    <button type="button" class="btn btn-outline-secondary filter-btn" data-filter="SYSTEM">
                                        Hệ thống
                                    </button>
                                </div>
                            </div>

                            <!-- DataTable -->
                            <table id="notificationsTable" class="table table-striped">
                                <thead>
                                    <tr>
                                        <th>ID</th>
                                        <th>Loại</th>
                                        <th>Người nhận</th>
                                        <th>Tiêu đề</th>
                                        <th>Nội dung</th>
                                        <th>Thời gian</th>
                                        <th>Trạng thái</th>
                                        <th>Thao tác</th>
                                    </tr>
                                </thead>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Modal tạo thông báo mới -->
        <div class="modal fade" id="createNotificationModal" tabindex="-1">
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">Tạo thông báo mới</h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <form id="createNotificationForm">
                            <div class="mb-3">
                                <label class="form-label">Loại thông báo</label>
                                <select class="form-select" id="notificationType" required>
                                    <option value="VACCINE">Tiêm lẻ</option>
                                    <option value="PACKAGE">Tiêm gói</option>
                                    <option value="PAYMENT">Thanh toán</option>
                                    <option value="SYSTEM">Hệ thống</option>
                                </select>
                            </div>

                            <div class="mb-3">
                            </div>

                            <div class="mb-3">
                                <label class="form-label">Người nhận</label>
                                <div class="d-flex gap-2">
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="recipientType" id="allUsers" value="all" checked>
                                        <label class="form-check-label" for="allUsers">
                                            Tất cả người dùng
                                        </label>
                                    </div>
                                    <div class="form-check">
                                        <input class="form-check-input" type="radio" name="recipientType" id="specificUser" value="specific">
                                        <label class="form-check-label" for="specificUser">
                                            Người dùng cụ thể
                                        </label>
                                    </div>
                                </div>
                            </div>

                            <div id="userSelect" class="mb-3 d-none">
                                <label class="form-label">Chọn người dùng</label>
                                <select class="form-select" id="userId">
                                    <option value="">Chọn người dùng...</option>
                                </select>
                            </div>

                            <div class="mb-3">
                                <label class="form-label">Tiêu đề</label>
                                <input type="text" class="form-control" id="notificationTitle" required>
                            </div>

                            <div class="mb-3">
                                <label class="form-label">Nội dung</label>
                                <textarea class="form-control" id="notificationContent" rows="3" required></textarea>
                            </div>

                            <!-- Checkbox gửi email -->
                            <div class="mb-3 form-check">
                                <input type="checkbox" class="form-check-input" id="sendEmailCheckbox">
                                <label class="form-check-label" for="sendEmailCheckbox">
                                    Gửi thông báo qua email
                                </label>
                            </div>
                        </form>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Đóng</button>
                        <button type="button" class="btn btn-primary" id="saveNotification">Lưu & Gửi</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/overlayscrollbars@2.10.1/browser/overlayscrollbars.browser.es6.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.13.6/js/dataTables.bootstrap5.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.7.32/dist/sweetalert2.all.min.js"></script>
    <script th:src="@{/dist/js/adminlte.js}"></script>
    <script th:src="@{/js/admin/notifications/notifications.js}"></script>
</body>
</html>
